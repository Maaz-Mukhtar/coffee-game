<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coffee Shop Idle Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 1200px;
            width: 100%;
            padding: 30px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Navigation */
        .nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .nav button {
            padding: 10px 20px;
            background: #6c63ff;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .nav button:hover {
            background: #5a52d5;
            transform: translateY(-2px);
        }

        .nav button.active {
            background: #4a42b5;
        }

        /* Pages */
        .page {
            display: none;
            animation: slideIn 0.3s ease-in;
        }

        .page.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Home Page */
        .home-page {
            text-align: center;
            padding: 40px;
        }

        .coffee-icon {
            font-size: 100px;
            margin: 20px 0;
            animation: steam 2s ease-in-out infinite;
        }

        @keyframes steam {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .home-page h1 {
            color: #333;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        .home-page .start-btn {
            padding: 15px 40px;
            font-size: 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
        }

        .home-page .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        /* Rules Page */
        .rules-content {
            padding: 20px;
            line-height: 1.8;
        }

        .rules-content h2 {
            color: #6c63ff;
            margin: 20px 0 10px 0;
        }

        .rules-content ul {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        /* Settings Page */
        .settings-content {
            padding: 20px;
        }

        .setting-item {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .setting-item label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
        }

        .setting-item input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }

        .setting-item button {
            padding: 10px 20px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .setting-item button:hover {
            background: #c82333;
        }

        .theme-selector {
            display: flex;
            gap: 10px;
        }

        .theme-btn {
            padding: 10px 20px;
            background: #6c63ff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .theme-btn:hover {
            background: #5a52d5;
        }

        .theme-btn.active {
            background: #4a42b5;
        }

        /* Game Page */
        .game-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .game-content {
                grid-template-columns: 1fr;
            }
        }

        .game-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .game-section h3 {
            color: #6c63ff;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .resource-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: white;
            margin: 10px 0;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .resource-item:hover {
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .resource-icon {
            font-size: 24px;
            margin-right: 10px;
        }

        .resource-count {
            font-weight: bold;
            font-size: 1.2em;
            color: #333;
        }

        .action-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
            font-size: 16px;
        }

        .action-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .action-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .coffee-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .coffee-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .coffee-item:hover {
            border-color: #6c63ff;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .coffee-item.can-afford {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
        }

        .coffee-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .coffee-price {
            color: #666;
            font-size: 0.9em;
        }

        .upgrade-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .upgrade-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .upgrade-info h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .upgrade-description {
            color: #666;
            font-size: 0.9em;
        }

        .upgrade-cost {
            font-weight: bold;
            color: #6c63ff;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #6c63ff;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }

        /* Achievements */
        .achievement {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            opacity: 0.3;
            transition: all 0.3s;
        }

        .achievement.unlocked {
            opacity: 1;
            animation: achievementPop 0.5s ease-out;
        }

        @keyframes achievementPop {
            0% { transform: scale(0.8); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .achievement-icon {
            font-size: 24px;
            margin-right: 10px;
        }

        /* Dark Theme */
        body.dark-theme {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
        }

        body.dark-theme .container {
            background: #0f0f1e;
            color: #e0e0e0;
        }

        body.dark-theme .game-section {
            background: #1a1a2e;
        }

        body.dark-theme .resource-item,
        body.dark-theme .coffee-item,
        body.dark-theme .upgrade-item,
        body.dark-theme .stat-card {
            background: #16213e;
            color: #e0e0e0;
        }

        body.dark-theme h1, body.dark-theme h2, body.dark-theme h3, body.dark-theme h4 {
            color: #9d9dff;
        }

        body.dark-theme .resource-count {
            color: #e0e0e0;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: slideInRight 0.3s ease-out;
            z-index: 1000;
            display: none;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .notification.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <div class="nav">
            <button onclick="showPage('home')" class="nav-btn active">Home</button>
            <button onclick="showPage('game')" class="nav-btn">Game</button>
            <button onclick="showPage('rules')" class="nav-btn">Rules</button>
            <button onclick="showPage('settings')" class="nav-btn">Settings</button>
        </div>

        <!-- Home Page -->
        <div id="home" class="page active">
            <div class="home-page">
                <div class="coffee-icon">‚òï</div>
                <h1>Welcome to Your Coffee Shop</h1>
                <p>Build your coffee empire from the ground up! Gather ingredients, brew delicious coffee, and serve happy customers.</p>
                <button class="start-btn" onclick="startGame()">Start Game</button>
            </div>
        </div>

        <!-- Rules Page -->
        <div id="rules" class="page">
            <div class="rules-content">
                <h1>How to Play</h1>
                
                <h2>üå± Gathering Resources</h2>
                <ul>
                    <li>Click buttons to gather coffee beans, milk, and sugar</li>
                    <li>Resources are needed to brew different types of coffee</li>
                    <li>Upgrade your gathering to collect more resources at once</li>
                </ul>

                <h2>‚òï Brewing Coffee</h2>
                <ul>
                    <li><strong>Espresso:</strong> Requires 3 coffee beans</li>
                    <li><strong>Latte:</strong> Requires 2 coffee beans + 2 milk</li>
                    <li><strong>Cappuccino:</strong> Requires 2 coffee beans + 1 milk + 1 sugar</li>
                    <li><strong>Americano:</strong> Requires 2 coffee beans</li>
                    <li><strong>Mocha:</strong> Requires 3 coffee beans + 2 milk + 2 sugar</li>
                    <li><strong>Macchiato:</strong> Requires 2 coffee beans + 1 milk</li>
                </ul>

                <h2>üí∞ Earning Money</h2>
                <ul>
                    <li>Each coffee type sells for a different price</li>
                    <li>Use money to purchase upgrades</li>
                    <li>Upgrades help you gather resources faster and brew more efficiently</li>
                </ul>

                <h2>üöÄ Upgrades</h2>
                <ul>
                    <li><strong>Better Tools:</strong> Gather more resources per click</li>
                    <li><strong>Auto-Gatherers:</strong> Automatically collect resources over time</li>
                    <li><strong>Barista Training:</strong> Increase coffee selling prices</li>
                    <li><strong>Shop Expansion:</strong> Unlock new features and bonuses</li>
                </ul>

                <h2>üèÜ Achievements</h2>
                <p>Unlock achievements by reaching milestones in your coffee shop journey!</p>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings" class="page">
            <div class="settings-content">
                <h1>Settings</h1>
                
                <div class="setting-item">
                    <label>Sound Volume</label>
                    <input type="range" id="volumeSlider" min="0" max="100" value="50">
                    <span id="volumeValue">50%</span>
                </div>

                <div class="setting-item">
                    <label>Theme</label>
                    <div class="theme-selector">
                        <button class="theme-btn active" onclick="setTheme('light')">Light</button>
                        <button class="theme-btn" onclick="setTheme('dark')">Dark</button>
                    </div>
                </div>

                <div class="setting-item">
                    <label>Game Progress</label>
                    <p>Reset all your progress and start fresh</p>
                    <button onclick="resetGame()">Reset Game</button>
                </div>

                <div class="setting-item">
                    <label>Auto-Save</label>
                    <p>Game automatically saves every 10 seconds</p>
                </div>
            </div>
        </div>

        <!-- Game Page -->
        <div id="game" class="page">
            <div class="game-content">
                <!-- Resources Section -->
                <div class="game-section">
                    <h3>Resources</h3>
                    <div class="resource-item">
                        <span><span class="resource-icon">‚òï</span> Coffee Beans</span>
                        <span class="resource-count" id="coffeeBeans">0</span>
                    </div>
                    <div class="resource-item">
                        <span><span class="resource-icon">ü•õ</span> Milk</span>
                        <span class="resource-count" id="milk">0</span>
                    </div>
                    <div class="resource-item">
                        <span><span class="resource-icon">üçØ</span> Sugar</span>
                        <span class="resource-count" id="sugar">0</span>
                    </div>
                    <div class="resource-item">
                        <span><span class="resource-icon">üíµ</span> Money</span>
                        <span class="resource-count" id="money">0</span>
                    </div>
                    
                    <h3 style="margin-top: 20px;">Gather Resources</h3>
                    <button class="action-btn" onclick="gatherResource('coffeeBeans')">
                        Gather Coffee Beans <span id="beansPerClick">(+1)</span>
                    </button>
                    <button class="action-btn" onclick="gatherResource('milk')">
                        Gather Milk <span id="milkPerClick">(+1)</span>
                    </button>
                    <button class="action-btn" onclick="gatherResource('sugar')">
                        Gather Sugar <span id="sugarPerClick">(+1)</span>
                    </button>
                </div>

                <!-- Coffee Brewing Section -->
                <div class="game-section">
                    <h3>Brew Coffee</h3>
                    <div class="coffee-grid" id="coffeeGrid">
                        <!-- Coffee items will be generated here -->
                    </div>
                    
                    <h3 style="margin-top: 20px;">Shop Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="totalCoffees">0</div>
                            <div class="stat-label">Coffees Brewed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalEarnings">$0</div>
                            <div class="stat-label">Total Earnings</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="perSecond">$0/s</div>
                            <div class="stat-label">Income Rate</div>
                        </div>
                    </div>
                </div>

                <!-- Upgrades Section -->
                <div class="game-section">
                    <h3>Upgrades</h3>
                    <div id="upgradesList">
                        <!-- Upgrades will be generated here -->
                    </div>
                </div>

                <!-- Achievements Section -->
                <div class="game-section">
                    <h3>Achievements</h3>
                    <div id="achievementsList">
                        <!-- Achievements will be generated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
        // Game State
        let gameState = {
            resources: {
                coffeeBeans: 0,
                milk: 0,
                sugar: 0,
                money: 0
            },
            stats: {
                totalCoffees: 0,
                totalEarnings: 0,
                coffeesBrewedByType: {}
            },
            upgrades: {
                coffeeGathering: 0,
                milkGathering: 0,
                sugarGathering: 0,
                autoGatherer: 0,
                priceMultiplier: 0,
                brewSpeed: 0
            },
            achievements: [],
            lastSave: Date.now()
        };

        // Coffee Types
        const coffeeTypes = [
            { name: 'Espresso', beans: 3, milk: 0, sugar: 0, price: 5, icon: '‚òï' },
            { name: 'Latte', beans: 2, milk: 2, sugar: 0, price: 7, icon: '‚òï' },
            { name: 'Cappuccino', beans: 2, milk: 1, sugar: 1, price: 8, icon: '‚òï' },
            { name: 'Americano', beans: 2, milk: 0, sugar: 0, price: 4, icon: '‚òï' },
            { name: 'Mocha', beans: 3, milk: 2, sugar: 2, price: 10, icon: '‚òï' },
            { name: 'Macchiato', beans: 2, milk: 1, sugar: 0, price: 6, icon: '‚òï' }
        ];

        // Upgrades Configuration
        const upgradesConfig = [
            {
                id: 'coffeeGathering',
                name: 'Better Coffee Grinder',
                description: 'Gather +1 more coffee beans per click',
                cost: 50,
                multiplier: 1.5
            },
            {
                id: 'milkGathering',
                name: 'Premium Milk Supplier',
                description: 'Gather +1 more milk per click',
                cost: 40,
                multiplier: 1.5
            },
            {
                id: 'sugarGathering',
                name: 'Sugar Rush',
                description: 'Gather +1 more sugar per click',
                cost: 30,
                multiplier: 1.5
            },
            {
                id: 'autoGatherer',
                name: 'Auto-Gatherer',
                description: 'Automatically gather 1 of each resource per second',
                cost: 200,
                multiplier: 2
            },
            {
                id: 'priceMultiplier',
                name: 'Premium Pricing',
                description: 'Increase all coffee prices by 20%',
                cost: 300,
                multiplier: 1.8
            },
            {
                id: 'brewSpeed',
                name: 'Expert Barista',
                description: 'Brew coffee 50% faster',
                cost: 150,
                multiplier: 1.6
            }
        ];

        // Achievements
        const achievements = [
            { id: 'first_coffee', name: 'First Brew', description: 'Brew your first coffee', icon: 'üèÜ' },
            { id: 'coffee_10', name: 'Novice Barista', description: 'Brew 10 coffees', icon: 'ü•â' },
            { id: 'coffee_50', name: 'Expert Barista', description: 'Brew 50 coffees', icon: 'ü•à' },
            { id: 'coffee_100', name: 'Master Barista', description: 'Brew 100 coffees', icon: 'ü•á' },
            { id: 'money_100', name: 'First Hundred', description: 'Earn $100', icon: 'üí∞' },
            { id: 'money_1000', name: 'Thousand Club', description: 'Earn $1000', icon: 'üíé' },
            { id: 'all_coffee_types', name: 'Menu Master', description: 'Brew all coffee types', icon: 'üìú' },
            { id: 'first_upgrade', name: 'Investor', description: 'Purchase your first upgrade', icon: 'üìà' }
        ];

        // Initialize Game
        function initGame() {
            loadGame();
            renderCoffeeTypes();
            renderUpgrades();
            renderAchievements();
            updateDisplay();
            startAutoGathering();
            startAutoSave();
        }

        // Page Navigation
        function showPage(pageName) {
            const pages = document.querySelectorAll('.page');
            const navButtons = document.querySelectorAll('.nav-btn');
            
            pages.forEach(page => page.classList.remove('active'));
            navButtons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(pageName).classList.add('active');
            event.target.classList.add('active');
        }

        // Start Game
        function startGame() {
            showPage('game');
            document.querySelector('.nav-btn:nth-child(2)').classList.add('active');
            document.querySelector('.nav-btn:nth-child(1)').classList.remove('active');
        }

        // Resource Gathering
        function gatherResource(type) {
            let amount = 1;
            
            if (type === 'coffeeBeans') {
                amount += gameState.upgrades.coffeeGathering;
            } else if (type === 'milk') {
                amount += gameState.upgrades.milkGathering;
            } else if (type === 'sugar') {
                amount += gameState.upgrades.sugarGathering;
            }
            
            gameState.resources[type] += amount;
            updateDisplay();
            showNotification(`+${amount} ${type === 'coffeeBeans' ? 'Coffee Beans' : type.charAt(0).toUpperCase() + type.slice(1)}`);
        }

        // Brew Coffee
        function brewCoffee(coffeeType) {
            const coffee = coffeeTypes.find(c => c.name === coffeeType);
            
            if (canAffordCoffee(coffee)) {
                // Deduct resources
                gameState.resources.coffeeBeans -= coffee.beans;
                gameState.resources.milk -= coffee.milk;
                gameState.resources.sugar -= coffee.sugar;
                
                // Add money
                const price = Math.floor(coffee.price * (1 + gameState.upgrades.priceMultiplier * 0.2));
                gameState.resources.money += price;
                
                // Update stats
                gameState.stats.totalCoffees++;
                gameState.stats.totalEarnings += price;
                if (!gameState.stats.coffeesBrewedByType[coffeeType]) {
                    gameState.stats.coffeesBrewedByType[coffeeType] = 0;
                }
                gameState.stats.coffeesBrewedByType[coffeeType]++;
                
                // Check achievements
                checkAchievements();
                
                updateDisplay();
                showNotification(`Brewed ${coffeeType}! +$${price}`);
            }
        }

        // Check if player can afford coffee
        function canAffordCoffee(coffee) {
            return gameState.resources.coffeeBeans >= coffee.beans &&
                   gameState.resources.milk >= coffee.milk &&
                   gameState.resources.sugar >= coffee.sugar;
        }

        // Purchase Upgrade
        function purchaseUpgrade(upgradeId) {
            const upgrade = upgradesConfig.find(u => u.id === upgradeId);
            const level = gameState.upgrades[upgradeId];
            const cost = Math.floor(upgrade.cost * Math.pow(upgrade.multiplier, level));
            
            if (gameState.resources.money >= cost) {
                gameState.resources.money -= cost;
                gameState.upgrades[upgradeId]++;
                
                if (gameState.upgrades[upgradeId] === 1) {
                    unlockAchievement('first_upgrade');
                }
                
                renderUpgrades();
                updateDisplay();
                showNotification(`Purchased ${upgrade.name}!`);
            }
        }

        // Render Coffee Types
        function renderCoffeeTypes() {
            const coffeeGrid = document.getElementById('coffeeGrid');
            coffeeGrid.innerHTML = '';
            
            coffeeTypes.forEach(coffee => {
                const canAfford = canAffordCoffee(coffee);
                const price = Math.floor(coffee.price * (1 + gameState.upgrades.priceMultiplier * 0.2));
                
                const coffeeItem = document.createElement('div');
                coffeeItem.className = `coffee-item ${canAfford ? 'can-afford' : ''}`;
                coffeeItem.onclick = () => brewCoffee(coffee.name);
                
                coffeeItem.innerHTML = `
                    <div style="font-size: 30px;">${coffee.icon}</div>
                    <div class="coffee-name">${coffee.name}</div>
                    <div class="coffee-price">$${price}</div>
                    <div style="font-size: 0.8em; color: #999; margin-top: 5px;">
                        ${coffee.beans > 0 ? `‚òï${coffee.beans} ` : ''}
                        ${coffee.milk > 0 ? `ü•õ${coffee.milk} ` : ''}
                        ${coffee.sugar > 0 ? `üçØ${coffee.sugar}` : ''}
                    </div>
                `;
                
                coffeeGrid.appendChild(coffeeItem);
            });
        }

        // Render Upgrades
        function renderUpgrades() {
            const upgradesList = document.getElementById('upgradesList');
            upgradesList.innerHTML = '';
            
            upgradesConfig.forEach(upgrade => {
                const level = gameState.upgrades[upgrade.id];
                const cost = Math.floor(upgrade.cost * Math.pow(upgrade.multiplier, level));
                const canAfford = gameState.resources.money >= cost;
                
                const upgradeItem = document.createElement('div');
                upgradeItem.className = 'upgrade-item';
                upgradeItem.innerHTML = `
                    <div class="upgrade-info">
                        <h4>${upgrade.name} (Level ${level})</h4>
                        <div class="upgrade-description">${upgrade.description}</div>
                    </div>
                    <div>
                        <div class="upgrade-cost">$${cost}</div>
                        <button class="action-btn" onclick="purchaseUpgrade('${upgrade.id}')" 
                                ${!canAfford ? 'disabled' : ''}>
                            Buy
                        </button>
                    </div>
                `;
                
                upgradesList.appendChild(upgradeItem);
            });
        }

        // Render Achievements
        function renderAchievements() {
            const achievementsList = document.getElementById('achievementsList');
            achievementsList.innerHTML = '';
            
            achievements.forEach(achievement => {
                const isUnlocked = gameState.achievements.includes(achievement.id);
                
                const achievementItem = document.createElement('div');
                achievementItem.className = `achievement ${isUnlocked ? 'unlocked' : ''}`;
                achievementItem.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div>
                        <strong>${achievement.name}</strong><br>
                        <small>${achievement.description}</small>
                    </div>
                `;
                
                achievementsList.appendChild(achievementItem);
            });
        }

        // Check Achievements
        function checkAchievements() {
            // Coffee brewing achievements
            if (gameState.stats.totalCoffees >= 1) unlockAchievement('first_coffee');
            if (gameState.stats.totalCoffees >= 10) unlockAchievement('coffee_10');
            if (gameState.stats.totalCoffees >= 50) unlockAchievement('coffee_50');
            if (gameState.stats.totalCoffees >= 100) unlockAchievement('coffee_100');
            
            // Money achievements
            if (gameState.stats.totalEarnings >= 100) unlockAchievement('money_100');
            if (gameState.stats.totalEarnings >= 1000) unlockAchievement('money_1000');
            
            // All coffee types
            if (Object.keys(gameState.stats.coffeesBrewedByType).length === coffeeTypes.length) {
                unlockAchievement('all_coffee_types');
            }
        }

        // Unlock Achievement
        function unlockAchievement(achievementId) {
            if (!gameState.achievements.includes(achievementId)) {
                gameState.achievements.push(achievementId);
                const achievement = achievements.find(a => a.id === achievementId);
                showNotification(`üèÜ Achievement Unlocked: ${achievement.name}!`);
                renderAchievements();
            }
        }

        // Update Display
        function updateDisplay() {
            // Resources
            document.getElementById('coffeeBeans').textContent = Math.floor(gameState.resources.coffeeBeans);
            document.getElementById('milk').textContent = Math.floor(gameState.resources.milk);
            document.getElementById('sugar').textContent = Math.floor(gameState.resources.sugar);
            document.getElementById('money').textContent = Math.floor(gameState.resources.money);
            
            // Gathering amounts
            document.getElementById('beansPerClick').textContent = `(+${1 + gameState.upgrades.coffeeGathering})`;
            document.getElementById('milkPerClick').textContent = `(+${1 + gameState.upgrades.milkGathering})`;
            document.getElementById('sugarPerClick').textContent = `(+${1 + gameState.upgrades.sugarGathering})`;
            
            // Stats
            document.getElementById('totalCoffees').textContent = gameState.stats.totalCoffees;
            document.getElementById('totalEarnings').textContent = `$${Math.floor(gameState.stats.totalEarnings)}`;
            
            // Update coffee display
            renderCoffeeTypes();
        }

        // Auto Gathering
        function startAutoGathering() {
            setInterval(() => {
                if (gameState.upgrades.autoGatherer > 0) {
                    gameState.resources.coffeeBeans += gameState.upgrades.autoGatherer;
                    gameState.resources.milk += gameState.upgrades.autoGatherer;
                    gameState.resources.sugar += gameState.upgrades.autoGatherer;
                    updateDisplay();
                }
                
                // Calculate income per second
                const incomePerSecond = gameState.upgrades.autoGatherer * 2; // Rough estimate
                document.getElementById('perSecond').textContent = `$${incomePerSecond}/s`;
            }, 1000);
        }

        // Notifications
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }

        // Settings Functions
        function setTheme(theme) {
            if (theme === 'dark') {
                document.body.classList.add('dark-theme');
            } else {
                document.body.classList.remove('dark-theme');
            }
            
            // Update theme buttons
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Save theme preference
            localStorage.setItem('coffeeShopTheme', theme);
        }

        // Volume Slider
        document.getElementById('volumeSlider').addEventListener('input', function() {
            document.getElementById('volumeValue').textContent = this.value + '%';
            localStorage.setItem('coffeeShopVolume', this.value);
        });

        // Save and Load Game
        function saveGame() {
            localStorage.setItem('coffeeShopGameState', JSON.stringify(gameState));
            gameState.lastSave = Date.now();
        }

        function loadGame() {
            const savedGame = localStorage.getItem('coffeeShopGameState');
            if (savedGame) {
                gameState = JSON.parse(savedGame);
            }
            
            // Load theme
            const savedTheme = localStorage.getItem('coffeeShopTheme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
            }
            
            // Load volume
            const savedVolume = localStorage.getItem('coffeeShopVolume');
            if (savedVolume) {
                document.getElementById('volumeSlider').value = savedVolume;
                document.getElementById('volumeValue').textContent = savedVolume + '%';
            }
        }

        function resetGame() {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone!')) {
                gameState = {
                    resources: {
                        coffeeBeans: 0,
                        milk: 0,
                        sugar: 0,
                        money: 0
                    },
                    stats: {
                        totalCoffees: 0,
                        totalEarnings: 0,
                        coffeesBrewedByType: {}
                    },
                    upgrades: {
                        coffeeGathering: 0,
                        milkGathering: 0,
                        sugarGathering: 0,
                        autoGatherer: 0,
                        priceMultiplier: 0,
                        brewSpeed: 0
                    },
                    achievements: [],
                    lastSave: Date.now()
                };
                
                saveGame();
                renderUpgrades();
                renderAchievements();
                updateDisplay();
                showNotification('Game Reset!');
            }
        }

        // Auto-save every 10 seconds
        function startAutoSave() {
            setInterval(() => {
                saveGame();
            }, 10000);
        }

        // Initialize when page loads
        window.onload = initGame;
        
        // Save when leaving page
        window.onbeforeunload = saveGame;
    </script>
</body>
</html>